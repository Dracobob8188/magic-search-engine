- if @pack.is_a?(WeightedPack)
  #{@pack.name} has variants:
  %ul
    - @pack.packs.each do |pack, weight|
      %li
        #{weight}/#{@pack.total_weight} (#{(100.0*weight/@pack.total_weight).round(2)}%)
        %ul
          - pack.sheets.each do |sheet, count|
            %li
              #{count}x Sheet #{sheet.name}
- else
  %div
    #{@pack.name} has no variants:
  %div
    %ul
      - @pack.sheets.each do |sheet, count|
        %li
          #{count}x Sheet #{sheet.name}

- if @pack.is_a?(WeightedPack)
  - sheets = @pack.packs.keys.flat_map(&:sheets).flat_map(&:keys).uniq
- else
  - sheets = @pack.sheets.keys

%h3 Sheets

- sheets.each do |sheet|
  %h4
    - if sheet.class == ColorBalancedCardSheet
      Sheet #{sheet.name} (color balanced)
    - else
      Sheet #{sheet.name}
  - groups = sheet.probabilities.group_by(&:last).transform_values{|x| x.map(&:first).sort}.sort.reverse
  - groups.each do |weight, cards|
    %div
      At rate #{weight} (#{(100.0*weight).round(2)}%)
    .row.multicard_row
      - cards.each_with_index do |card, i|
        .col-3.col-sm-2.card_picture_cell{class: "card_#{i % 6}_of_6 card_#{i % 4}_of_4"}
          = link_to_card(card) do
            = render 'card/picture', card: card
